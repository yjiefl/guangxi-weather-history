# 天气查询系统 - 使用说明文档 (Guide)

更新日期：2026-01-31

## 1. 快速入门

### 1.1 本地启动 (macOS)

1. 在项目根目录下，直接双击运行 `start.command`。
2. 脚本会自动初始化环境并启动服务。
3. 浏览器会自动打开 `http://localhost:5001`。

### 1.2 远程部署

* **NAS 部署**: 使用 `docker-compose up -d --build` 或 `./sync_to_nas.sh`。
* **VPS 部署**: 使用 `./deploy_to_vps.sh` 脚本。
* **关闭服务**: 在项目根目录下运行 `./stop.sh` (Linux/VPS) 或双击 `stop.command` (macOS)。

## 2. 功能详细说明

### 2.1 统计看板 (Dashboard)

* **实时天气**: 显示所选城市的当前温度、天气状况、风速和湿度。
* **未来 7 天预报**: 展示未来一周的天气趋势，包括最高/最低温、降水概率。
* **15 分钟级趋势**: 点击“今日趋势”或“明日展望”可查看精细化的气象变化曲线。

### 2.2 历史查询

* **全自动下载**: 如果本地数据库没有您请求的日期数据，系统会自动从 Open-Meteo API 下载并补全。
* **本地优先**: 系统优先从本地读取已有的历史数据，提供秒级的查询体验。
* **多维度数据**: 支持查看温度、降水、风速（10m, 100m等）、辐照度（短波、直接、散射等）。

### 2.3 数据管理

* **城市管理**:
  * 可以通过搜索功能添加全球任何城市。
  * 支持“手动输入坐标”并自定义命名（即将推出）。
* **批量下载**: 选定城市和日期范围后，可以一键将数据持久化到本地。
* **数据导出**:
  * **Excel/CSV**: 支持将查询结果或数据库中的完整字段导出。

## 3. 部署与维护

### 3.1 Docker 部署

项目支持容器化，默认映射端口为 `5002` (主机) -> `5001` (容器)。

### 3.2 配置文件

* 后端主配置位于 `backend/config.py`。
* Docker 配置位于 `Dockerfile` 和 `docker-compose.yml`。

## 4. 常见问题 (FAQ)

**Q: 为什么无法查询到今天的数据？**
A: Open-Meteo 的历史 API 通常有 5 天左右的延迟。如需最近几天或未来的数据，请使用“天气预报 & 实况”板块。

**Q: 如何清空本地缓存？**
A: 在“数据管理”页面，您可以选择特定城市或点击“清空全部”来删除本地数据库中的历史记录。

**Q: 部署到 VPS 后无法访问？**
A: 检查 VPS 防火墙是否放行了 `5002` 端口，并确保 Docker 服务正在运行。
